<div class="min-h-screen bg-gray-50 p-8">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="bg-white shadow rounded-lg p-6 mb-6">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-3xl font-bold text-gray-900 mb-2">Employee Master</h1>
                    <p class="text-gray-600">Manage all employees in the system</p>
                </div>
                <div class="flex space-x-3">
                    <button *ngIf="hasChanges()" (click)="saveChanges()" [disabled]="loading()"
                        class="px-6 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50">
                        <i class="fas fa-save mr-2"></i>{{ loading() ? 'Saving...' : 'Save Changes' }}
                    </button>
                    <button *ngIf="hasChanges()" (click)="cancelChanges()"
                        class="px-6 py-3 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">
                        <i class="fas fa-times mr-2"></i>Cancel Changes
                    </button>
                </div>
            </div>
        </div>

        <!-- Loading State -->
        <div *ngIf="loading()" class="bg-white shadow rounded-lg p-6 mb-6">
            <div class="flex items-center justify-center">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
                <span class="ml-2 text-gray-600">Loading employees...</span>
            </div>
        </div>

        <!-- Error State -->
        <div *ngIf="error()" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6">
            {{ error() }}
        </div>

        <!-- Employee Table -->
        <div *ngIf="!loading() && !error()" class="bg-white shadow rounded-lg overflow-hidden">
            <div class="px-6 py-4 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h2 class="text-xl font-semibold text-gray-900">Employee List</h2>
                    <div class="flex space-x-3">
                        <!-- Global Search -->
                        <input type="text" [ngModel]="globalSearch()" (ngModelChange)="globalSearch.set($event)"
                            placeholder="Global search..."
                            class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <!-- Name Sort -->
                        <select [ngModel]="nameSort()" (ngModelChange)="nameSort.set($event)"
                            class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">Sort by Name</option>
                            <option value="asc">A-Z</option>
                            <option value="desc">Z-A</option>
                        </select>
                        <!-- Clear Filters -->
                        <button (click)="clearAllFilters()"
                            class="px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">
                            Clear Filters
                        </button>
                    </div>
                </div>
            </div>

            <!-- Filters Row -->
            <div class="px-6 py-4 border-b border-gray-200 bg-gray-50">
                <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                    <!-- Email Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                        <input type="text" [ngModel]="filterEmail()" (ngModelChange)="filterEmail.set($event)"
                            placeholder="Filter by email"
                            class="w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500">
                    </div>

                    <!-- Role Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Role</label>
                        <select [ngModel]="filterRole()" (ngModelChange)="filterRole.set($event)"
                            class="w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500">
                            <option value="">All Roles</option>
                            <option value="admin">Admin</option>
                            <option value="hr">HR</option>
                            <option value="employee">Employee</option>
                        </select>
                    </div>

                    <!-- Department Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Department</label>
                        <select [ngModel]="filterDepartment()" (ngModelChange)="filterDepartment.set($event)"
                            class="w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500">
                            <option value="">All Departments</option>
                            <option *ngFor="let dept of departments()" [value]="dept.departmentName">
                                {{ dept.departmentName }}
                            </option>
                        </select>
                    </div>

                    <!-- Designation Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Designation</label>
                        <select [ngModel]="filterDesignation()" (ngModelChange)="filterDesignation.set($event)"
                            class="w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500">
                            <option value="">All Designations</option>
                            <option *ngFor="let desig of designations()" [value]="desig.designationName">
                                {{ desig.designationName }}
                            </option>
                        </select>
                    </div>

                    <!-- Status Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                        <select [ngModel]="filterStatus()" (ngModelChange)="filterStatus.set($event)"
                            class="w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500">
                            <option value="">All Status</option>
                            <option value="pending">Pending</option>
                            <option value="approved">Approved</option>
                            <option value="rejected">Rejected</option>
                        </select>
                    </div>

                    <!-- Grade Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Grade</label>
                        <input type="text" [ngModel]="filterGrade()" (ngModelChange)="filterGrade.set($event)"
                            placeholder="Filter by grade"
                            class="w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500">
                    </div>

                    <!-- PF Number Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">PF Number</label>
                        <input type="text" [ngModel]="filterPfNumber()" (ngModelChange)="filterPfNumber.set($event)"
                            placeholder="Filter by PF number"
                            class="w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500">
                    </div>

                    <!-- ESI Number Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ESI Number</label>
                        <input type="text" [ngModel]="filterEsiNumber()" (ngModelChange)="filterEsiNumber.set($event)"
                            placeholder="Filter by ESI number"
                            class="w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500">
                    </div>

                    <!-- Bank Account Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Bank Account</label>
                        <input type="text" [ngModel]="filterBankAccount()"
                            (ngModelChange)="filterBankAccount.set($event)" placeholder="Filter by bank account"
                            class="w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500">
                    </div>

                    <!-- Bank Name Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Bank Name</label>
                        <input type="text" [ngModel]="filterBankName()" (ngModelChange)="filterBankName.set($event)"
                            placeholder="Filter by bank name"
                            class="w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500">
                    </div>

                    <!-- IFSC Code Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">IFSC Code</label>
                        <input type="text" [ngModel]="filterIfscCode()" (ngModelChange)="filterIfscCode.set($event)"
                            placeholder="Filter by IFSC code"
                            class="w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500">
                    </div>

                    <!-- Father's Name Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Father's Name</label>
                        <input type="text" [ngModel]="filterFatherName()" (ngModelChange)="filterFatherName.set($event)"
                            placeholder="Filter by father's name"
                            class="w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500">
                    </div>

                    <!-- Mother's Name Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Mother's Name</label>
                        <input type="text" [ngModel]="filterMotherName()" (ngModelChange)="filterMotherName.set($event)"
                            placeholder="Filter by mother's name"
                            class="w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500">
                    </div>

                    <!-- Date of Birth Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Date of Birth</label>
                        <input type="text" [ngModel]="filterDob()" (ngModelChange)="filterDob.set($event)"
                            placeholder="Filter by DOB"
                            class="w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500">
                    </div>

                    <!-- Date of Joining Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Date of Joining</label>
                        <input type="text" [ngModel]="filterDateOfJoining()"
                            (ngModelChange)="filterDateOfJoining.set($event)" placeholder="Filter by joining date"
                            class="w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500">
                    </div>
                </div>
            </div>

            <!-- Table -->
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Name
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Email
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Role
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Father's Name
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Mother's Name
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Date of Birth
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Date of Joining
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Department
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Designation
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                PF Number
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                ESI Number
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Bank Account
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Bank Name
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                IFSC Code
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Grade
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Status
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Actions
                            </th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <tr *ngFor="let employee of filteredEmployees(); let i = index">
                            <td class="px-6 py-4 whitespace-nowrap">
                                <input type="text" [(ngModel)]="employee.fullName" (ngModelChange)="onFieldChange()"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    style="min-width: 200px;">
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <input type="email" [(ngModel)]="employee.email" (ngModelChange)="onFieldChange()"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    style="min-width: 200px;">
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <select [(ngModel)]="employee.role" (ngModelChange)="onFieldChange()"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    style="min-width: 200px;">
                                    <option value="employee">Employee</option>
                                    <option value="hr">HR</option>
                                    <option value="admin">Admin</option>
                                </select>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <input type="text" [(ngModel)]="employee.fatherName" (ngModelChange)="onFieldChange()"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    style="min-width: 200px;">
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <input type="text" [(ngModel)]="employee.motherName" (ngModelChange)="onFieldChange()"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    style="min-width: 200px;">
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <input type="text" [(ngModel)]="employee.dob" (ngModelChange)="onFieldChange()"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    style="min-width: 200px;">
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <input type="text" [(ngModel)]="employee.dateOfJoining"
                                    (ngModelChange)="onFieldChange()"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    style="min-width: 200px;">
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <select [(ngModel)]="employee.department" (ngModelChange)="onFieldChange()"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    style="min-width: 200px;">
                                    <option *ngFor="let dept of departments()" [value]="dept.departmentName">
                                        {{ dept.departmentName }}
                                    </option>
                                </select>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <select [(ngModel)]="employee.designation" (ngModelChange)="onFieldChange()"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    style="min-width: 200px;">
                                    <option *ngFor="let desig of designations()" [value]="desig.designationName">
                                        {{ desig.designationName }}
                                    </option>
                                </select>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <input type="text" [(ngModel)]="employee.pfNumber" (ngModelChange)="onFieldChange()"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    style="min-width: 200px;">
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <input type="text" [(ngModel)]="employee.esiNumber" (ngModelChange)="onFieldChange()"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    style="min-width: 200px;">
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <input type="text" [(ngModel)]="employee.bankAccount" (ngModelChange)="onFieldChange()"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    style="min-width: 200px;">
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <input type="text" [(ngModel)]="employee.bankName" (ngModelChange)="onFieldChange()"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    style="min-width: 200px;">
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <input type="text" [(ngModel)]="employee.ifscCode" (ngModelChange)="onFieldChange()"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    style="min-width: 200px;">
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <input type="text" [(ngModel)]="employee.grade" (ngModelChange)="onFieldChange()"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    style="min-width: 200px;">
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                    [class.bg-yellow-100]="employee.status === 'pending'"
                                    [class.text-yellow-800]="employee.status === 'pending'"
                                    [class.bg-green-100]="employee.status === 'approved'"
                                    [class.text-green-800]="employee.status === 'approved'"
                                    [class.bg-red-100]="employee.status === 'rejected'"
                                    [class.text-red-800]="employee.status === 'rejected'">
                                    {{ employee.status }}
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                <div class="flex space-x-2">
                                    <button (click)="saveChanges()" [disabled]="!hasChanges() || loading()"
                                        class="text-green-600 hover:text-green-900 disabled:opacity-50">
                                        Save
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Empty State -->
            <div *ngIf="filteredEmployees().length === 0" class="text-center py-12">
                <p class="text-gray-500">No employees found.</p>
            </div>
        </div>
    </div>
</div>